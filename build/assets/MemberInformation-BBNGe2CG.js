import{r as h,j as e,C as ee}from"./index-C94lwiJv.js";import{a as b}from"./index.esm-DV_CLorw.js";import{E as re,a as O}from"./jspdf.plugin.autotable-C9i-e47c.js";import{l as Y}from"./logo1-_GWK0zuy.js";import{C as x,a as j}from"./CForm-By0H7RBh.js";import{C as U}from"./index-CynBYxOh.js";import{C as y}from"./CAlert-h_oXZGtT.js";import{c as $}from"./cil-magnifying-glass-COgjSVTM.js";import{C as se,a as te}from"./CInputGroupText-Cjvru9WV.js";import{b as ne,a as J}from"./CFormInput-ChrqK6Lh.js";import{a as ae,c as oe}from"./cil-info-CGjZWabf.js";import{C as me}from"./CCardTitle-Bc26m0la.js";import{C as K,a as V}from"./CRow-Bgj36awN.js";import{C as p,a as n}from"./CListGroupItem-C8Y0l3z_.js";import{J as ie}from"./DefaultLayout-BFpOW43o.js";import"./typeof-QjJsDpFa.js";import"./CCloseButton-fePu8NsK.js";import"./cil-user-Ddrdy7PS.js";function Ae(){const[g,X]=h.useState(""),[r,S]=h.useState(null),[_,w]=h.useState(!1),[I,P]=h.useState(null),A=async()=>{if(g){w(!0),P(null),S(null);try{const s=await fetch(`http://192.168.12.245:8594/api/registrations/transfer?zp=${g}`);if(!s.ok){let N=(await s.text()).replace("An error occurred:","").trim();throw P(N),new Error("Failed to fetch data")}const l=await s.json();S(l)}catch(s){console.log(s.message)}finally{w(!1)}}};console.log(r);const q=async()=>{var B,M,D,E,T,Z,z,F,G,v,R,k,W,H,L;if(!r)return;const s=new re,l=210,f=10,N=o=>new Promise((d,C)=>{const a=new Image;a.crossOrigin="Anonymous",a.src=o,a.onload=()=>{const t=document.createElement("canvas");t.width=a.width,t.height=a.height,t.getContext("2d").drawImage(a,0,0),d(t.toDataURL("image/png"))},a.onerror=t=>C(t)});try{let o="";if(Y&&(o=await N(Y)),o){const m=(l-40)/2;s.addImage(o,"PNG",m,f,40,40)}s.setFontSize(14),s.text("PCEA ZIMMERMAN MEMBER INFORMATION REPORT",l/2,f+60,{align:"center"});let d=80;const C=["Label","Value"],a=[],t=(u,i)=>{i&&a.push([u,i])};t("Full Name",r.fullName),t("Wife",r.name),t("Mobile Number",r.mobileNumber),t("ZP Number",r.zpnumber),t("Holy Communion Status",(B=r.member)==null?void 0:B.holyCommunionStatus),t("Marital Status",(M=r.member)==null?void 0:M.maritalStatus),t("District",(D=r.member)==null?void 0:D.district),t("National ID",(E=r.member)==null?void 0:E.nationalID),t("Spouse Name",(T=r.member)==null?void 0:T.spouseName),t("Spouse ZP Number",(Z=r.member)==null?void 0:Z.spouseZPNumber),t("EPC Number",(z=r.member)==null?void 0:z.ePCNumber),t("DOB",(F=r.member)==null?void 0:F.dob),t("Gender",(G=r.member)==null?void 0:G.gender),t("Card Serial Number",(v=r.member)==null?void 0:v.cardSerialNumber),t("Created At",(R=r.member)==null?void 0:R.createdAt),t("Updated At",(k=r.member)==null?void 0:k.updatedAt),t("Created By",(W=r.member)==null?void 0:W.createdBy),t("Updated By",(H=r.member)==null?void 0:H.updatedBy),O(s,{head:[C],body:a,startY:d});let c=((L=s.lastAutoTable)==null?void 0:L.finalY)+15||d+15;if(Array.isArray(r.child)&&r.child.length>0){s.setFontSize(14),s.text("Children Information",10,c),c+=8;const u=["#","Full Name","Guardian ZP","Baptized","Communicant","Guardian Telephone"],i=[];r.child.forEach((m,Q)=>{i.push([Q+1,m.fullName||"-",m.guardianZpNumber||"-",m.baptized||"-",m.communicant||"-",m.guardianTelephone||"-"])}),O(s,{head:[u],body:i,startY:c})}s.save(`Member_${r.zpnumber}.pdf`)}catch(o){console.error("Error loading images:",o)}};return e.jsx("div",{children:e.jsxs(x,{children:[e.jsxs(U,{children:[e.jsxs(y,{color:"primary",variant:"solid",style:{display:"flex",marginTop:"10px"},children:[e.jsx(b,{icon:$,size:"xxl"}),e.jsx("h3",{children:"Member Information"})]}),e.jsxs(se,{className:"mb-3",children:[e.jsx(te,{style:{backgroundColor:"rgb(71, 71, 212)",color:"#fff"},children:e.jsx(b,{icon:$})}),e.jsx(ne,{placeholder:"Search by Zpnumber ( Enter 4 digit )","aria-label":"Search by Zpnumber","aria-describedby":"button-addon2",type:"number",value:g,onChange:s=>X(s.target.value),onKeyDown:s=>{s.key==="Enter"&&A()}}),e.jsx(J,{type:"button",onClick:A,color:"primary",style:{backgroundColor:"rgb(71, 71, 212)",color:"#fff"},variant:"outline",id:"button-addon2",children:_?e.jsx(ee,{size:"sm"}):"Search"})]})]}),e.jsxs(j,{children:[I&&e.jsxs(y,{color:"primary",className:"d-flex align-items-center",children:[e.jsx(b,{icon:ae,className:"flex-shrink-0 me-2",width:24,height:24}),e.jsx("div",{children:I})]}),r&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"container mt-2",children:e.jsxs(x,{className:"p-2",style:{border:"none"},children:[e.jsxs(U,{className:"bg-primary text-white text-center",children:[e.jsx(me,{className:"h3 mb-0 mt-2",children:r.fullName}),e.jsx("p",{children:"Member"})]}),e.jsxs(j,{children:[e.jsx(K,{children:e.jsxs(p,{flush:!0,className:"mt-3",children:[e.jsxs(K,{children:[e.jsx(V,{md:6,children:e.jsx(x,{className:"mb-3",children:e.jsx(j,{children:e.jsxs(p,{flush:!0,children:[r.fullName&&e.jsxs(n,{children:[e.jsx("strong",{children:"Full Name:"})," ",r.fullName]}),r.name&&e.jsxs(n,{children:[e.jsx("strong",{children:"Wife:"})," ",r.name]}),r.mobileNumber&&e.jsxs(n,{children:[e.jsx("strong",{children:"Mobile Number:"})," ",r.mobileNumber]}),r.zpnumber&&e.jsxs(n,{children:[e.jsx("strong",{children:"ZP Number:"})," ",r.zpnumber]}),r.member.holyCommunionStatus&&e.jsxs(n,{children:[e.jsx("strong",{children:"Holy Communion Status:"})," ",r.member.holyCommunionStatus]}),r.member.maritalStatus&&e.jsxs(n,{children:[e.jsx("strong",{children:"Marital Status :"})," ",r.member.maritalStatus]}),r.member.district&&e.jsxs(n,{children:[e.jsx("strong",{children:"District :"})," ",r.member.district]}),r.member.nationalID&&e.jsxs(n,{children:[e.jsx("strong",{children:"NationalID :"})," ",r.member.nationalID]}),r.member.spouseName&&e.jsxs(n,{children:[e.jsx("strong",{children:"Spouse Name:"})," ",r.member.spouseName]}),r.member.spouseZPNumber&&e.jsxs(n,{children:[e.jsx("strong",{children:"SpouseZPNumber :"})," ",r.member.spouseZPNumber]}),r.member.ePCNumber&&e.jsxs(n,{children:[e.jsx("strong",{children:"EPC Number :"})," ",r.member.ePCNumber]})]})})})}),e.jsx(V,{md:6,children:e.jsx(x,{className:"mb-3",children:e.jsx(j,{children:e.jsxs(p,{flush:!0,children:[r.member.dob&&e.jsxs(n,{children:[e.jsx("strong",{children:"Date of Birth :"})," ",r.member.dob]}),r.member.gender&&e.jsxs(n,{children:[e.jsx("strong",{children:"Gender :"})," ",r.member.gender]}),r.member.cardSerialNumber&&e.jsxs(n,{children:[e.jsx("strong",{children:"Card Serial Number :"})," ",r.member.cardSerialNumber]}),r.member.createdAt&&e.jsxs(n,{children:[e.jsx("strong",{children:"createdAt:"})," ",r.member.createdAt]}),r.member.updatedAt&&e.jsxs(n,{children:[e.jsx("strong",{children:"updatedAt :"})," ",r.member.updatedAt]}),r.member.createdBy&&e.jsxs(n,{children:[e.jsx("strong",{children:"createdBy :"})," ",r.member.createdBy]}),r.member.updatedBy&&e.jsxs(n,{children:[e.jsx("strong",{children:"updatedBy :"})," ",r.member.updatedBy]})]})})})})]}),e.jsx("div",{className:"mb-4"}),r.child&&r.child.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs(y,{children:[e.jsx("strong",{children:"Children"}),e.jsxs("div",{children:["Number of Children : ",r.child.length]})]}),r.child.map(s=>e.jsx(ie,{color:"primary",children:e.jsxs(p,{flush:!0,children:[e.jsxs(n,{children:[e.jsx("strong",{children:"Name:"})," ",s.fullName," "]}),e.jsxs(n,{children:[" ",e.jsx("strong",{children:"Guardian ZP:"})," ",s.guardianZpNumber]}),e.jsxs(n,{children:[" ",e.jsx("strong",{children:"Baptized:"})," ",s.baptized," "]}),e.jsxs(n,{children:[" ",e.jsx("strong",{children:"Communicant:"})," ",s.communicant," "]}),e.jsxs(n,{children:["  ",s.guardianTelephone&&e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Guardian Telephone:"})," ",s.guardianTelephone]})]})]},s.id)}))]})]})}),e.jsxs(J,{color:"success",style:{color:"#fff"},className:"mt-3",onClick:q,children:[e.jsx(b,{icon:oe,className:"me-2"})," Download Member PDF"]})]})]})})})]})]})})}export{Ae as default};
