import{r as o,j as e}from"./index-C94lwiJv.js";import{S as b}from"./sweetalert2.all-huutmort.js";import{c as M,d as v,e as $,n as H,E as y,o as z,p as I,q as S,r as l,s as V,t as c}from"./DefaultLayout-BFpOW43o.js";import{C as W,a as L}from"./CForm-By0H7RBh.js";import{C as q,a as O}from"./index-CynBYxOh.js";import{a as j}from"./CFormInput-ChrqK6Lh.js";import{b as Y,c as Z,d as D,e as G}from"./logo1-_GWK0zuy.js";import{C as J}from"./CFormTextarea-qcd-aoMf.js";import"./index.esm-DV_CLorw.js";import"./CCloseButton-fePu8NsK.js";import"./cil-user-Ddrdy7PS.js";const ae=()=>{const[n,h]=o.useState("rejoining");return e.jsxs(e.Fragment,{children:[e.jsxs(M,{variant:"tabs",children:[e.jsx(v,{children:e.jsx($,{style:{fontWeight:"bold",cursor:"pointer"},active:n==="rejoining",onClick:()=>h("rejoining"),children:"Parish Minister Approval"})}),e.jsx(v,{})]}),e.jsxs(H,{children:[e.jsx(y,{visible:n==="rejoining",children:e.jsx(T,{apiUrl:"http://192.168.12.245:8594/api/registrations/getmembertansfer?status=2",activeTab:n})}),e.jsx(y,{visible:n==="evangelist",children:e.jsx(T,{apiUrl:"http://192.168.12.245:8594/api/registrations/elderApproved",activeTab:n})})]})]})},T=({apiUrl:n,activeTab:h})=>{const[p,w]=o.useState([]),[N,u]=o.useState(!0),[x,m]=o.useState(""),[E,d]=o.useState(!1),[r,k]=o.useState(null),[f,A]=o.useState(""),[g,F]=o.useState(""),[C,P]=o.useState(!0);o.useEffect(()=>{(async()=>{u(!0),m("");try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const a=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);const i=await a.json();console.log("API Response:",i),w(Array.isArray(i)?i:[])}catch(t){console.error("Error fetching data:",t),m(t.message)}finally{u(!1)}})()},[n,C]);const R=s=>{k(s),d(!0)},B=async()=>{if(r)try{const s=localStorage.getItem("token");if(!s)throw new Error("No token found");const t={id:r.id,status:f,comments:g},a=await fetch("http://192.168.12.245:8594/api/registrations/approvetransfer",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(t)});if(!a.ok){const i=await a.json();throw new Error(i.message||"Failed to submit registration data.")}b.fire({title:"Success!",text:"Registration data submitted successfully.",icon:"success",timer:2e3,showConfirmButton:!1}),d(!1),P(!C)}catch(s){console.error("Error submitting request:",s),b.fire("Error",s.message||"Failed to submit registration data.","error")}};return e.jsxs(e.Fragment,{children:[e.jsxs(W,{className:"mb-4",children:[e.jsx(q,{children:e.jsx("h3",{style:{color:"blue",fontWeight:"bold"},children:"Member Transfer"})}),e.jsx(L,{children:N?e.jsx("p",{children:"Loading members..."}):x?e.jsxs("p",{style:{color:"red"},children:["404!: ",x]}):p.length===0?e.jsx("p",{}):e.jsxs(z,{striped:!0,bordered:!0,hover:!0,children:[e.jsx(I,{children:e.jsxs(S,{children:[e.jsx(l,{children:"No."}),e.jsx(l,{children:"Name"}),e.jsx(l,{children:"ZP Number"}),e.jsx(l,{children:"Phone Number"}),e.jsx(l,{children:"Actions"})]})}),e.jsx(V,{children:p.map((s,t)=>e.jsxs(S,{children:[e.jsx(c,{style:{fontWeight:"bold"},children:t+1}),e.jsx(c,{children:s.names}),e.jsx(c,{children:s.zp}),e.jsx(c,{children:s.telephone}),e.jsx(c,{children:e.jsx(j,{style:{color:"white",fontWeight:"bold"},color:"info",onClick:()=>R(s),children:"View More"})})]},t))})]})})]}),e.jsxs(Y,{visible:E,onClose:()=>d(!1),children:[e.jsx(Z,{children:r==null?void 0:r.names}),e.jsxs(D,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Full Name:"})," ",r==null?void 0:r.names]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ZP Number:"})," ",r==null?void 0:r.zp]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Mobile Number:"})," ",r==null?void 0:r.telephone]}),e.jsxs(O,{value:f,onChange:s=>A(s.target.value),children:[e.jsx("option",{value:"",children:"Transfer"}),h==="rejoining"?e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"3",children:"Yes"}),e.jsx("option",{value:"2",children:"No"})]}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"3",children:"Yes"}),e.jsx("option",{value:"2",children:"No"})]})]}),e.jsx(J,{value:g,onChange:s=>F(s.target.value),placeholder:"Enter comments"})]}),e.jsxs(G,{children:[e.jsx(j,{style:{color:"white"},color:"success",onClick:B,children:"Approve"}),e.jsx(j,{color:"secondary",onClick:()=>d(!1),children:"Close"})]})]})]})};export{ae as default};
