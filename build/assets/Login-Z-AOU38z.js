const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ParticlesBackground-Ch64DmGw.js","./index-C94lwiJv.js","./index-C0XKtBuA.css"])))=>i.map(i=>d[i]);
var M=Object.defineProperty;var O=(s,a,t)=>a in s?M(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t;var n=(s,a,t)=>O(s,typeof a!="symbol"?a+"":a,t);import{R as U,f as B,r as o,o as F,j as e}from"./index-C94lwiJv.js";import{C as R,a as j}from"./index.esm-DV_CLorw.js";import{f as D,l as A,b as H,c as J,d as W,e as Y}from"./logo1-_GWK0zuy.js";import{t as G}from"./LdrsBaseElement-BpkUX6A7.js";import{C as q,a as P}from"./CRow-Bgj36awN.js";import{C as V,a as K,b as Q}from"./CForm-By0H7RBh.js";import{C as h,a as p}from"./CInputGroupText-Cjvru9WV.js";import{c as X}from"./cil-user-Ddrdy7PS.js";import{b as u,a as m}from"./CFormInput-ChrqK6Lh.js";import{c as Z}from"./cil-lock-locked-DmxpJbVL.js";import"./CCloseButton-fePu8NsK.js";var k=':host{align-items:center;display:inline-flex;flex-shrink:0;height:var(--uib-size);justify-content:center;width:var(--uib-size)}:host([hidden]){display:none}.container{align-items:center;display:flex;height:var(--uib-size);justify-content:flex-start;position:relative;width:var(--uib-size)}.line{align-items:flex-start;display:flex;height:100%;left:calc(50% - var(--uib-stroke)/2);position:absolute;top:0;width:var(--uib-stroke)}.line:before{animation:pulse calc(var(--uib-speed)) ease-in-out infinite;background-color:var(--uib-color);border-radius:calc(var(--uib-stroke)/2);content:"";height:22%;transform-origin:center bottom;transition:background-color .3s ease;width:100%}.line:first-child{transform:rotate(-30deg)}.line:first-child:before{animation-delay:calc(var(--uib-speed)/-12*1)}.line:nth-child(2){transform:rotate(-60deg)}.line:nth-child(2):before{animation-delay:calc(var(--uib-speed)/-12*2)}.line:nth-child(3){transform:rotate(-90deg)}.line:nth-child(3):before{animation-delay:calc(var(--uib-speed)/-12*3)}.line:nth-child(4){transform:rotate(-120deg)}.line:nth-child(4):before{animation-delay:calc(var(--uib-speed)/-12*4)}.line:nth-child(5){transform:rotate(-150deg)}.line:nth-child(5):before{animation-delay:calc(var(--uib-speed)/-12*5)}.line:nth-child(6){transform:rotate(-180deg)}.line:nth-child(6):before{animation-delay:calc(var(--uib-speed)/-12*6)}.line:nth-child(7){transform:rotate(-210deg)}.line:nth-child(7):before{animation-delay:calc(var(--uib-speed)/-12*7)}.line:nth-child(8){transform:rotate(-240deg)}.line:nth-child(8):before{animation-delay:calc(var(--uib-speed)/-12*8)}.line:nth-child(9){transform:rotate(-270deg)}.line:nth-child(9):before{animation-delay:calc(var(--uib-speed)/-12*9)}.line:nth-child(10){transform:rotate(-300deg)}.line:nth-child(10):before{animation-delay:calc(var(--uib-speed)/-12*10)}.line:nth-child(11){transform:rotate(-330deg)}.line:nth-child(11):before{animation-delay:calc(var(--uib-speed)/-12*11)}@keyframes pulse{0%,80%,to{opacity:0;transform:scaleY(.75)}20%{opacity:1;transform:scaleY(1)}}';class S extends G{constructor(){super();n(this,"_attributes",["size","color","speed","stroke"]);n(this,"size");n(this,"color");n(this,"speed");n(this,"stroke");this.storePropsToUpgrade(this._attributes),this.reflect(this._attributes)}static get observedAttributes(){return["size","color","speed","stroke"]}connectedCallback(){this.upgradeStoredProps(),this.applyDefaultProps({size:40,color:"black",speed:1,stroke:3}),this.template.innerHTML=`
      <div class="container">
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
      </div>
      <style>
        :host{
          --uib-size: ${this.size}px;
          --uib-color: ${this.color};
          --uib-speed: ${this.speed}s;
          --uib-stroke: ${this.stroke}px;
        }
        ${k}
      </style>
    `,this.shadow.replaceChildren(this.template.content.cloneNode(!0))}attributeChangedCallback(){const t=this.shadow.querySelector("style");t&&(t.innerHTML=`
      :host{
        --uib-size: ${this.size}px;
        --uib-color: ${this.color};
        --uib-speed: ${this.speed}s;
        --uib-stroke: ${this.stroke}px;
      }
      ${k}
    `)}}var ee={register:(s="l-line-spinner")=>{customElements.get(s)||customElements.define(s,class extends S{})},element:S};const se=U.lazy(()=>B(()=>import("./ParticlesBackground-Ch64DmGw.js"),__vite__mapDeps([0,1,2]),import.meta.url));ee.register();const me=()=>{const[s,a]=o.useState(""),[t,N]=o.useState(""),[f,z]=o.useState(""),[y,I]=o.useState(""),[v,x]=o.useState(null),[$,w]=o.useState(!1),[T,d]=o.useState(!1),E=F(),L=async r=>{var l,C;r.preventDefault(),x(null),w(!0),console.log("http://192.168.12.245:8598/auth/login");try{const c=await fetch("http://192.168.12.245:8598/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({UserName:s,Password:t})});if(!c.ok)throw new Error("Invalid username or password");const i=await c.json(),b=(C=(l=i==null?void 0:i.user)==null?void 0:l.authorities[0])==null?void 0:C.roleId;if(!b)throw new Error("You did not input Username and Password.");localStorage.setItem("token",i.jwt),localStorage.setItem("user",JSON.stringify(i.user)),localStorage.setItem("username",s),localStorage.setItem("roleId",b),i.user.firstlogin===0?d(!0):E("/dashboard")}catch(c){x(c.message)}finally{w(!1)}},_=async()=>{if(f!==y){alert("Passwords do not match! Please try again.");return}try{const l=await(await fetch("http://192.168.12.245:8598/auth/changepin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({UserName:s,OldPassword:t,NewPassword:f})})).json();l.status==="00"?(alert("Password changed successfully. Please log in with your new password."),d(!1)):alert(l.statusDescription||"Failed to change password.")}catch{alert("Error changing password. Please try again.")}},g={width:"100%"};return e.jsx(se,{children:e.jsxs("div",{className:"min-vh-100 d-flex flex-row align-items-center",children:[e.jsx(R,{children:e.jsx(q,{className:"justify-content-center",children:e.jsx(P,{md:4,children:e.jsx(V,{className:"p-4",style:{boxShadow:"0px 15px 34px rgba(0,0,0,0.2)"},children:e.jsx(K,{children:e.jsxs(Q,{onSubmit:L,style:{textAlign:"center"},children:[e.jsx(D,{rounded:!0,src:A,height:150}),e.jsx("h1",{style:{marginTop:"20px",color:"#374ad6"},children:"Login"}),v&&e.jsx("p",{style:{color:"red"},children:v}),$&&e.jsx("div",{style:{marginBottom:"20px"},children:e.jsx("l-line-spinner",{size:"40",stroke:"3",speed:"1",color:"blue"})}),e.jsxs(h,{className:"mb-3",style:g,children:[e.jsx(p,{style:{backgroundColor:"rgb(71, 71, 212)",color:"#fff"},children:e.jsx(j,{icon:X})}),e.jsx(u,{placeholder:"Username",autoComplete:"username",value:s,onChange:r=>a(r.target.value),style:{borderColor:"rgb(71, 71, 212)"}})]}),e.jsxs(h,{className:"mb-4",style:g,children:[e.jsx(p,{style:{backgroundColor:"rgb(71, 71, 212)",color:"#fff"},children:e.jsx(j,{icon:Z})}),e.jsx(u,{type:"password",placeholder:"Password",autoComplete:"current-password",value:t,onChange:r=>N(r.target.value),style:{borderColor:"rgb(71, 71, 212)"}})]}),e.jsxs(P,{style:{marginTop:"20px"},children:[e.jsx(m,{type:"submit",color:"primary",style:g,children:"Login"}),e.jsx(m,{style:{fontWeight:"bold",marginTop:"10px"},color:"link",children:"Forgot Password"})]})]})})})})})}),e.jsxs(H,{visible:T,onClose:()=>d(!1),children:[e.jsx(J,{style:{fontWeight:"bold"},children:"Change Password"}),e.jsxs(W,{children:[e.jsx("p",{style:{fontWeight:"bold"},children:"Please change your password to continue."}),e.jsxs(h,{className:"mb-3",children:[e.jsx(p,{children:"New Password"}),e.jsx(u,{type:"password",placeholder:"Enter new password",value:f,onChange:r=>z(r.target.value)})]}),e.jsxs(h,{className:"mb-3",children:[e.jsx(p,{children:"Confirm Password"}),e.jsx(u,{type:"password",placeholder:"Confirm new password",value:y,onChange:r=>I(r.target.value)})]})]}),e.jsxs(Y,{children:[e.jsx(m,{color:"secondary",onClick:()=>d(!1),children:"Cancel"}),e.jsx(m,{color:"primary",onClick:_,children:"Submit"})]})]})]})})};export{me as default};
