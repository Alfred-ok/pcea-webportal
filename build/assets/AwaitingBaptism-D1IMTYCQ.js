import{r,j as e,C as M}from"./index--2Vg46XJ.js";import{S as x}from"./sweetalert2.all-BHDornT5.js";import{C as k,a as B,b as R}from"./CForm-uSoNT2u_.js";import{C as q,a as F}from"./index-Bp6JkL8A.js";import{C as L}from"./CAlert-CwhgRHPq.js";import{o as H,p as I,q as j,r as t,s as z,t as a}from"./DefaultLayout-JRVaWF0p.js";import{a as c}from"./CFormInput-DcpM5UbD.js";import{b as O,c as P,d as Z,e as $}from"./logo1-B-TheImU.js";import{C as J}from"./CModalTitle-Bc9MZI4H.js";import{C as V}from"./CFormTextarea-CBhWhc4W.js";import"./CCloseButton-CvX7nGj0.js";import"./index.esm-CI-HiMCL.js";import"./cil-user-Ddrdy7PS.js";function oe({ChangeStatus:C}){const[d,f]=r.useState([]),[u,b]=r.useState(!0),[i,S]=r.useState(null),[y,n]=r.useState(!1),[m,v]=r.useState(""),[p,g]=r.useState(""),[N,w]=r.useState(null),[T,D]=r.useState(""),[h,A]=r.useState(!0);r.useEffect(()=>{(async()=>{try{const o=await fetch("http://192.168.13.244:8594/api/registrations/getservicerequestTypeandstatus?ServiceType=baptismrequest&Status=4");if(!o.ok)throw new Error("Network response was not ok");const l=await o.json();f(l)}catch(o){S(o.message)}finally{b(!1)}})()},[h]);const E=async s=>{s.preventDefault();const o={ID:Number(N),Status:Number(m),Comment:p,ZpNumber:T,ServiceType:"BaptismRequest"};try{const l=await fetch("http://192.168.13.244:8594/api/registrations/servicerequestupdate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!l.ok)throw new Error("Failed to update status");console.log("Response:",await l.json()),x.fire({icon:"success",title:"Success!",text:"Status updated successfully!"}),n(!1),A(!h)}catch(l){console.error("Error updating status:",l),x.fire({icon:"error",title:"Oops...",text:"Failed to update status. Please try again."})}};return console.log(d),console.log(C),e.jsxs("div",{children:[e.jsxs(k,{className:"mt-4",children:[e.jsx(q,{style:{backgroundColor:"rgba(22, 89, 177, 0.925)"},children:e.jsx("h4",{style:{color:"#fff"},children:"Awaiting Baptism Confirmation"})}),e.jsxs(B,{children:[u&&e.jsx(M,{color:"primary"}),i&&e.jsx(L,{color:"danger",children:i}),!u&&!i&&e.jsxs(H,{bordered:!0,stripedColumns:!0,hover:!0,responsive:!0,small:!0,children:[e.jsx(I,{children:e.jsxs(j,{color:"primary",children:[e.jsx(t,{children:"ID"}),e.jsx(t,{children:"Date"}),e.jsx(t,{children:"Name"}),e.jsx(t,{children:"District"}),e.jsx(t,{children:"Marital Status"}),e.jsx(t,{children:"Mobile Number"}),e.jsx(t,{children:"Elder Name"}),e.jsx(t,{children:"Elder Comments"}),e.jsx(t,{children:"ZP Number"}),e.jsx(t,{children:"Action"})]})}),e.jsx(z,{children:d.map(s=>e.jsxs(j,{children:[e.jsx(a,{children:s.id}),e.jsx(a,{children:new Date(s.datex).toLocaleString()}),e.jsx(a,{children:s.name}),e.jsx(a,{children:s.district}),e.jsx(a,{children:s.maritalStatus}),e.jsx(a,{children:s.mobileNumber}),e.jsx(a,{children:s.elderName}),e.jsx(a,{children:s.elderComments||"N/A"}),e.jsx(a,{children:s.zpnumber}),e.jsx(a,{children:e.jsx(c,{color:"success",style:{color:"#fff"},onClick:()=>{n(!0),w(s.id),D(s.zpnumber)},children:"Approve"})})]},s.id))})]})]})]}),e.jsxs(O,{visible:y,onClose:()=>n(!1),"aria-labelledby":"LiveDemoExampleLabel",children:[e.jsx(P,{children:e.jsx(J,{id:"LiveDemoExampleLabel",children:"Approve Request"})}),e.jsx(Z,{children:e.jsxs(R,{onSubmit:E,children:[e.jsxs(F,{id:"registrationStatus",className:"form-control mt-2 mb-2",label:"Status",value:m,onChange:s=>v(s.target.value),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"5",children:"Yes"}),e.jsx("option",{value:"0",children:"No"})]}),e.jsx(V,{className:"mt-2",placeholder:"Add a comment",label:"Comments",value:p,onChange:s=>g(s.target.value)}),e.jsx(c,{style:{color:"#fff"},className:"mt-4",type:"submit",color:"success",children:"Approve"})]})}),e.jsx($,{children:e.jsx(c,{color:"secondary",onClick:()=>n(!1),children:"Close"})})]})]})}export{oe as default};
