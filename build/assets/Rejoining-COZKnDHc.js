import{r as t,j as e}from"./index--2Vg46XJ.js";import{S as C}from"./sweetalert2.all-BHDornT5.js";import{c as F,d as R,e as P,n as $,E as b,o as H,p as W,q as v,r as l,s as z,t as c}from"./DefaultLayout-JRVaWF0p.js";import{C as I,a as V}from"./CForm-uSoNT2u_.js";import{C as L,a as Y}from"./index-Bp6JkL8A.js";import{a as j}from"./CFormInput-DcpM5UbD.js";import{b as q,c as D,d as G,e as O}from"./logo1-B-TheImU.js";import{C as Z}from"./CFormTextarea-CBhWhc4W.js";import"./index.esm-CI-HiMCL.js";import"./CCloseButton-CvX7nGj0.js";import"./cil-user-Ddrdy7PS.js";const te=()=>{const[n,h]=t.useState("rejoining");return e.jsxs(e.Fragment,{children:[e.jsx(F,{variant:"tabs",children:e.jsx(R,{children:e.jsx(P,{style:{fontWeight:"bold",cursor:"pointer"},active:n==="rejoining",onClick:()=>h("rejoining"),children:"Admin Approval"})})}),e.jsxs($,{children:[e.jsx(b,{visible:n==="rejoining",children:e.jsx(S,{apiUrl:"http://192.168.13.244:8594/api/registrations/blockedMembers",activeTab:n})}),e.jsx(b,{visible:n==="evangelist",children:e.jsx(S,{apiUrl:"http://192.168.13.244:8594/api/registrations/elderApproved",activeTab:n})})]})]})},S=({apiUrl:n,activeTab:h})=>{const[p,y]=t.useState([]),[N,x]=t.useState(!0),[u,m]=t.useState(""),[w,d]=t.useState(!1),[r,T]=t.useState(null),[g,k]=t.useState(""),[f,E]=t.useState("");t.useEffect(()=>{(async()=>{x(!0),m("");try{const o=localStorage.getItem("token");if(!o)throw new Error("No token found");const a=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}});if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);const i=await a.json();console.log("API Response:",i),y(Array.isArray(i)?i:[])}catch(o){console.error("Error fetching data:",o),m(o.message)}finally{x(!1)}})()},[n]);const A=s=>{T(s),d(!0)},B=async()=>{if(r)try{const s=localStorage.getItem("token");if(!s)throw new Error("No token found");const o={id:r.id,status:g,comments:f},a=await fetch("http://192.168.13.244:8594/api/registrations/approvetransfer",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(o)});if(!a.ok){const i=await a.json();throw new Error(i.message||"Failed to submit registration data.")}C.fire({title:"Success!",text:"Registration data submitted successfully.",icon:"success",timer:2e3,showConfirmButton:!1}),d(!1)}catch(s){console.error("Error submitting request:",s),C.fire("Error",s.message||"Failed to submit registration data.","error")}};return e.jsxs(e.Fragment,{children:[e.jsxs(I,{className:"mb-4",children:[e.jsx(L,{children:e.jsx("h3",{style:{color:"blue",fontWeight:"bold"},children:"Welcome Back!"})}),e.jsx(V,{children:N?e.jsx("p",{children:"Loading members..."}):u?e.jsxs("p",{style:{color:"red"},children:["404!: ",u]}):p.length===0?e.jsx("p",{}):e.jsxs(H,{striped:!0,children:[e.jsx(W,{children:e.jsxs(v,{children:[e.jsx(l,{children:"No."}),e.jsx(l,{children:"Name"}),e.jsx(l,{children:"ZP Number"}),e.jsx(l,{children:"Card Serial Number"}),e.jsx(l,{children:"Actions"})]})}),e.jsx(z,{children:p.map((s,o)=>e.jsxs(v,{children:[e.jsx(c,{style:{fontWeight:"bold"},children:o+1}),e.jsx(c,{children:s.fullName}),e.jsx(c,{children:s.zpnumber}),e.jsx(c,{children:s.cardSerialNumber}),e.jsx(c,{children:e.jsx(j,{style:{color:"white",fontWeight:"bold"},color:"info",onClick:()=>A(s),children:"View More"})})]},o))})]})})]}),e.jsxs(q,{visible:w,onClose:()=>d(!1),children:[e.jsx(D,{children:r==null?void 0:r.fullName}),e.jsxs(G,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ZP Number:"})," ",r==null?void 0:r.zpnumber]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Card Serial Number:"})," ",r==null?void 0:r.cardSerialNumber]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Year of Birth:"})," ",r==null?void 0:r.dob]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Gender:"})," ",r==null?void 0:r.gender]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Mobile Number:"})," ",r==null?void 0:r.mobileNumber]}),e.jsxs("p",{children:[e.jsx("strong",{children:"District:"})," ",r==null?void 0:r.district]}),e.jsxs(Y,{value:g,onChange:s=>k(s.target.value),children:[e.jsx("option",{value:"",children:"Select Rejoin Status"}),h==="rejoining"?e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"8",children:"Yes"}),e.jsx("option",{value:"7",children:"No"})]}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"8",children:"Yes"}),e.jsx("option",{value:"7",children:"No"})]})]}),e.jsx(Z,{value:f,onChange:s=>E(s.target.value),placeholder:"Enter comments"})]}),e.jsxs(O,{children:[e.jsx(j,{style:{color:"white"},color:"success",onClick:B,children:"Approve"}),e.jsx(j,{color:"secondary",onClick:()=>d(!1),children:"Close"})]})]})]})};export{te as default};
