import{r as o,j as e,C as q}from"./index-C94lwiJv.js";import{o as J,p as _,q as k,r as n,s as Q,t as i,l as U,m as x,n as V,I as X}from"./DefaultLayout-BFpOW43o.js";import{C as E,a as Y}from"./CForm-By0H7RBh.js";import{C as ee,a as R}from"./index-CynBYxOh.js";import{b as te,a as se}from"./CFormInput-ChrqK6Lh.js";import re from"./AwaitingBaptism-CziVZQ0v.js";import{C as oe}from"./CAlert-h_oXZGtT.js";import{C as ae,a as ne,b as g,c as j}from"./CTabList-Cz2zYZrj.js";import"./index.esm-DV_CLorw.js";import"./CCloseButton-fePu8NsK.js";import"./cil-user-Ddrdy7PS.js";import"./logo1-_GWK0zuy.js";import"./sweetalert2.all-huutmort.js";import"./CModalTitle-ChywXEWD.js";import"./CFormTextarea-qcd-aoMf.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";function ie(){const[h,M]=o.useState([]),[u,m]=o.useState([]),[F,C]=o.useState(!0),[b,y]=o.useState(""),[l,c]=o.useState(1);o.useState(!1),o.useState(null);const[L,le]=o.useState("admitted"),[B,ce]=o.useState("11"),[f,W]=o.useState(""),[S,I]=o.useState(""),[w,K]=o.useState(""),[A,D]=o.useState(!0),p=300;o.useEffect(()=>{(async()=>{C(!0),y("");try{const s=localStorage.getItem("token");if(!s)throw new Error("No token found");const a=await fetch("http://192.168.12.245:8594/api/registrations/RejoiningMemberStatus?Status=10",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}});if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);const r=await a.json();console.log("API Response:",r),M(Array.isArray(r)?r:[]),m(Array.isArray(r)?r:[])}catch(s){console.error("Error fetching data:",s),y(s.message)}finally{C(!1)}})()},[A]);const G=t=>{const s=t.target.value;if(W(s),s.trim()==="")m(h);else{const a=h.filter(r=>r.zpnumber.toLowerCase().includes(s.toLowerCase()));m(a)}c(1)},v=(t,s,a)=>{let r=h;t.trim()!==""&&(r=r.filter(d=>d.zpnumber.toLowerCase().includes(t.toLowerCase()))),s&&(r=r.filter(d=>d.gender.toLowerCase()===s.toLowerCase())),a&&(r=r.filter(d=>d.district===a)),m(r),c(1)},$=t=>{I(t.target.value),v(f,t.target.value,w)},z=t=>{K(t.target.value),v(f,S,t.target.value)},H=async t=>{const s={id:t,status:B,comments:L};console.log(s);try{const a=localStorage.getItem("token");if(!a)throw new Error("No token found");if(!(await fetch("http://192.168.12.245:8594/api/registrations/approvetransfer",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(s)})).ok)throw new Error("Failed to update status");alert("Status updated successfully!"),D(!A)}catch(a){console.error("Error updating status:",a),alert("Error updating status. Please try again.")}},O=u.length,N=Math.ceil(O/p),P=l*p,T=P-p,Z=u.slice(T,P);return e.jsx(e.Fragment,{children:e.jsxs(E,{className:"mb-4",children:[e.jsx(ee,{style:{backgroundColor:"rgba(22, 89, 177, 0.925)"},children:e.jsx("h4",{style:{color:"#fff"},children:"Awaiting Readmission Confirmation"})}),e.jsxs(Y,{children:[e.jsxs("div",{className:"mb-3 d-flex justify-content-end align-items-center gap-3",children:[e.jsx(te,{type:"text",placeholder:"Search by ZP Number",value:f,onChange:G}),e.jsxs(R,{value:S,onChange:$,children:[e.jsx("option",{style:{fontWeight:"bold"},value:"",children:"All Genders"}),e.jsx("option",{style:{fontWeight:"bold"},value:"Male",children:"Male"}),e.jsx("option",{style:{fontWeight:"bold"},value:"Female",children:"Female"})]}),e.jsxs(R,{value:w,onChange:z,children:[e.jsx("option",{value:"",children:"All Districts"}),[...new Set(h.map(t=>t.district))].map(t=>e.jsx("option",{value:t,children:t},t))]})]}),F?e.jsxs("div",{className:"text-center",children:[e.jsx(q,{color:"primary"}),e.jsx("p",{children:"Loading members..."})]}):b?e.jsxs("p",{style:{color:"red",textAlign:"center"},children:["Error: ",b]}):u.length===0?e.jsx("p",{style:{textAlign:"center"},children:"No member records found."}):e.jsxs(e.Fragment,{children:[e.jsxs(J,{striped:!0,bordered:!0,hover:!0,children:[e.jsx(_,{children:e.jsxs(k,{children:[e.jsx(n,{children:"No."}),e.jsx(n,{children:"Full Name"}),e.jsx(n,{children:"District"}),e.jsx(n,{children:"Gender"}),e.jsx(n,{children:"ZP Number"}),e.jsx(n,{children:"Mobile Number"}),e.jsx(n,{children:"Action"})]})}),e.jsx(Q,{children:Z.map((t,s)=>e.jsxs(k,{children:[e.jsx(i,{style:{fontWeight:"bold",color:"blue"},children:T+s+1}),e.jsx(i,{children:t.fullName}),e.jsx(i,{children:t.district}),e.jsx(i,{children:t.gender}),e.jsx(i,{children:t.zPNumber}),e.jsx(i,{children:t.mobileNumber}),e.jsx(i,{children:e.jsx(se,{style:{color:"white",fontWeight:"bold"},color:"success",onClick:()=>{H(t.id)},children:"Readmit"})})]},s))})]}),e.jsxs(U,{className:"mt-3 justify-content-center",children:[e.jsx(x,{style:{cursor:"pointer",fontWeight:"bold"},disabled:l===1,onClick:()=>c(l-1),children:"Previous"}),Array.from({length:N},(t,s)=>e.jsx(x,{style:{fontWeight:"bold",cursor:"pointer"},active:s+1===l,onClick:()=>c(s+1),children:s+1},s+1)),e.jsx(x,{style:{fontWeight:"bold",cursor:"pointer"},disabled:l===N,onClick:()=>c(l+1),children:"Next"})]})]})]})]})})}function Ne(){return e.jsx(e.Fragment,{children:e.jsxs(E,{style:{boxShadow:"0px -2px 19px 1px rgba(0,0,0,0.39)",padding:"15px"},children:[e.jsx(oe,{style:{backgroundColor:"rgba(22, 89, 177, 0.925)"},children:e.jsx("h3",{style:{color:"#fff"},children:"Awaiting Confirmation"})}),e.jsxs(ae,{activeItemKey:"Admission",children:[e.jsxs(ne,{variant:"tabs",children:[e.jsx(g,{itemKey:"Admission",children:"Admission"}),e.jsx(g,{itemKey:"Readmission",children:"Readmission"}),e.jsx(g,{itemKey:"AwaitingBaptism",children:"Awaiting Baptism"})]}),e.jsxs(V,{children:[e.jsx(j,{className:"p-3",itemKey:"Admission",style:{backgroundColor:"#fff"},children:e.jsx(X,{})}),e.jsx(j,{className:"p-3",itemKey:"Readmission",style:{backgroundColor:"#fff"},children:e.jsx(ie,{})}),e.jsx(j,{className:"p-3",itemKey:"AwaitingBaptism",style:{backgroundColor:"#fff"},children:e.jsx(re,{})})]})]})]})})}export{Ne as default};
