import{r as o,j as e,C as B}from"./index--2Vg46XJ.js";import{C as H,g as z,a as A}from"./index-Bp6JkL8A.js";import{C as $,a as O}from"./CForm-uSoNT2u_.js";import{C as q}from"./CAlert-CwhgRHPq.js";import{b as _}from"./CFormInput-DcpM5UbD.js";import{o as J,p as K,q as F,r as i,s as Q,t as c,l as U,m as g}from"./DefaultLayout-JRVaWF0p.js";import{b as V}from"./logo1-B-TheImU.js";import"./CCloseButton-CvX7nGj0.js";import"./index.esm-CI-HiMCL.js";import"./cil-user-Ddrdy7PS.js";function ie(){const[u,T]=o.useState([]),[f,x]=o.useState([]),[E,m]=o.useState(!0),[C,y]=o.useState(""),[l,d]=o.useState(1);o.useState(!1),o.useState(null),o.useState(""),o.useState("7");const[j,L]=o.useState(""),[b,k]=o.useState(""),[S,R]=o.useState(""),p=300;o.useEffect(()=>{(async()=>{m(!0),y("");try{const r=localStorage.getItem("token");if(!r)throw new Error("No token found");const n=await fetch("http://192.168.13.244:8594/api/registrations/wrongholycommunionpartakers",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});if(!n.ok)throw new Error(`HTTP error! Status: ${n.status}`);const s=await n.json();console.log("API Response:",s),T(Array.isArray(s)?s:[]),x(Array.isArray(s)?s:[])}catch(r){console.error("Error fetching data:",r),y(r.message)}finally{m(!1)}})()},[]);const D=t=>{const r=t.target.value;if(L(r),r.trim()==="")x(u);else{const n=u.filter(s=>s.zpnumber.toLowerCase().includes(r.toLowerCase()));x(n)}d(1)},v=(t,r,n)=>{let s=u;t.trim()!==""&&(s=s.filter(a=>{var h,M;return(M=(h=a==null?void 0:a.zpnumber)==null?void 0:h.toLowerCase())==null?void 0:M.includes(t.toLowerCase())})),r&&(s=s.filter(a=>{var h;return((h=a==null?void 0:a.gender)==null?void 0:h.toLowerCase())===r.toLowerCase()})),n&&(s=s.filter(a=>(a==null?void 0:a.district)===n)),x(s),d(1)},G=t=>{k(t.target.value),v(j,t.target.value,S)},W=t=>{R(t.target.value),v(j,b,t.target.value)},I=f.length,w=Math.ceil(I/p),N=l*p,P=N-p,Z=f.slice(P,N);return e.jsxs(e.Fragment,{children:[e.jsxs($,{className:"mb-4",style:{boxShadow:"0 4px 8px rgba(0, 0, 0, 0.2)"},children:[e.jsx(H,{className:"mt-2",children:e.jsxs(q,{color:"primary",variant:"solid",style:{display:"flex",alignItems:"center"},children:[e.jsx(z,{style:{marginRight:"8px",fontSize:"40"}}),e.jsx("h3",{style:{color:"#fff"},children:"Barred Communicants"})]})}),e.jsxs(O,{children:[e.jsxs("div",{className:"mb-3 d-flex justify-content-end align-items-center gap-3",children:[e.jsx(_,{type:"text",placeholder:"Search by ZP Number",value:j,onChange:D}),e.jsxs(A,{value:b,onChange:G,children:[e.jsx("option",{style:{fontWeight:"bold"},value:"",children:"All Genders"}),e.jsx("option",{style:{fontWeight:"bold"},value:"Male",children:"Male"}),e.jsx("option",{style:{fontWeight:"bold"},value:"Female",children:"Female"})]}),e.jsxs(A,{value:S,onChange:W,children:[e.jsx("option",{value:"",children:"All Districts"}),[...new Set(u.map(t=>t.district))].map(t=>e.jsx("option",{value:t,children:t},t))]})]}),E?e.jsxs("div",{className:"text-center",children:[e.jsx(B,{color:"primary"}),e.jsx("p",{children:"Loading members..."})]}):C?e.jsxs("p",{style:{color:"red",textAlign:"center"},children:["Error: ",C]}):f.length===0?e.jsx("p",{style:{textAlign:"center"},children:"No member records found."}):e.jsxs(e.Fragment,{children:[e.jsxs(J,{bordered:!0,hover:!0,stripedColumns:!0,children:[e.jsx(K,{children:e.jsxs(F,{color:"primary",children:[e.jsx(i,{children:"No."}),e.jsx(i,{children:"Full Name"}),e.jsx(i,{children:"Mobile Number"}),e.jsx(i,{children:"ZP Number"}),e.jsx(i,{children:"Date"}),e.jsx(i,{children:"Gender"})]})}),e.jsx(Q,{children:Z.map((t,r)=>e.jsxs(F,{children:[e.jsx(c,{style:{fontWeight:"bold",color:"blue"},children:P+r+1}),e.jsx(c,{children:t.FullName}),e.jsx(c,{children:t.MobileNumber}),e.jsx(c,{children:t.ZPNumber}),e.jsx(c,{children:t.Datex}),e.jsx(c,{children:t.Gender})]},r))})]}),e.jsxs(U,{className:"mt-3 justify-content-center",children:[e.jsx(g,{style:{cursor:"pointer",fontWeight:"bold"},disabled:l===1,onClick:()=>d(l-1),children:"Previous"}),Array.from({length:w},(t,r)=>e.jsx(g,{style:{fontWeight:"bold",cursor:"pointer"},active:r+1===l,onClick:()=>d(r+1),children:r+1},r+1)),e.jsx(g,{style:{fontWeight:"bold",cursor:"pointer"},disabled:l===w,onClick:()=>d(l+1),children:"Next"})]})]})]})]}),e.jsx(V,{})]})}export{ie as default};
