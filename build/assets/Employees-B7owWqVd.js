import{r as l,o as q,j as e}from"./index--2Vg46XJ.js";import{S as w}from"./sweetalert2.all-BHDornT5.js";import{c as V,a as C}from"./index-Bp6JkL8A.js";import{E as G,a as X}from"./jspdf.plugin.autotable-xBXH9STM.js";import{a as Y}from"./index.esm-CI-HiMCL.js";import{b as _,c as K,d as Q,e as Z,l as ee}from"./logo1-B-TheImU.js";import{C as se,a as te,b as re}from"./CForm-uSoNT2u_.js";import{C as ne}from"./CCardTitle-Bhw-tENH.js";import{C as oe}from"./CAlert-CwhgRHPq.js";import{a as g,c as h,b as j}from"./CFormInput-DcpM5UbD.js";import{C as u,a as i}from"./CRow-BUZD3U73.js";import{c as ae}from"./cil-arrow-thick-to-bottom-B9H9Aet0.js";import{o as le,p as ie,q as A,r as n,s as ce,t as o}from"./DefaultLayout-JRVaWF0p.js";import{C as de}from"./CModalTitle-Bc9MZI4H.js";import"./typeof-QjJsDpFa.js";import"./CCloseButton-CvX7nGj0.js";import"./cil-user-Ddrdy7PS.js";const we=()=>{const[S,E]=l.useState([]),[R,he]=l.useState(1),[P,me]=l.useState(10),[F,y]=l.useState(!1),[t,T]=l.useState(null),[N,B]=l.useState(!1),[p,D]=l.useState(""),[x,U]=l.useState(""),z=q();l.useEffect(()=>{fetch("http://192.168.13.244:9595/api/employee/all").then(s=>s.json()).then(s=>E(s)).catch(s=>console.error("Error fetching data:",s))},[N]),l.useEffect(()=>{let s="http://192.168.13.244:9595/api/employee/filteremployees";if(p&&x)s+=`?jobType=${x}&department=${p}`;else if(p)s+=`?department=${p}`;else if(x)s+=`?jobType=${x}`;else return;fetch(s).then(r=>r.json()).then(r=>{E(r)}).catch(r=>setError("Error fetching filtered data: "+r.message))},[p,x,N]);const I=R*P,$=I-P,k=S.slice($,I),H=s=>{T(s),y(!0)},c=s=>{T({...t,[s.target.name]:s.target.value})},J=async()=>{if(!t||!t.id){console.error("No employee selected for update");return}try{fetch(`http://192.168.13.244:9595/api/employee/${t.id}/update`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(s=>{if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);const r=s.text();return console.log(r),r}).then(s=>{console.log("Server Response:",s),s=="Employee Updated Successfully"&&(w.fire({icon:"success",title:"Success",text:"Employee updated successfully!"}),B(!N)),y(!1)}).catch(s=>console.error("Error updating employee:",s))}catch(s){console.error("Error updating employee:",s),w.fire({icon:"error",title:"Update Failed",text:"There was an issue updating the employee details."}),y(!1)}};console.log(t);const L=async()=>{const s=new G,r=s.internal.pageSize.getWidth();s.internal.pageSize.getHeight();const W=f=>new Promise((b,v)=>{const d=new Image;d.crossOrigin="Anonymous",d.src=f,d.onload=()=>{const m=document.createElement("canvas");m.width=d.width,m.height=d.height,m.getContext("2d").drawImage(d,0,0),b(m.toDataURL("image/png"))},d.onerror=m=>v(m)});try{const b=await W(ee),v=40,d=40,m=(r-v)/2;s.addImage(b,"PNG",m,10,v,d),s.setFontSize(21),s.text("Employee Records",r/2,60,{align:"center"});const M=["UserId","First Name","Middle Name","Surname","Employee No.","Phone Number","Department","Job Type","Profession","Status"],O=S.map(a=>[a.id,a.firstName,a.middleName||"N/A",a.surname||"N/A",a.employeeNo,a.phoneNumber,a.department,a.jobType,a.profession||"N/A",a.status==0?"Inactive":"Active"]);X(s,{head:[M],body:O,startY:65,theme:"striped",styles:{fontSize:8,cellPadding:2},headStyles:{fontSize:9,fillColor:[44,62,80],textColor:255}}),s.save("Employee_Records.pdf")}catch(f){console.error("Error loading images:",f)}};return e.jsx("div",{className:"p-4",children:e.jsx(se,{className:"mb-4",children:e.jsxs(te,{children:[e.jsx(ne,{children:e.jsxs(oe,{color:"primary",variant:"solid",style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex"},children:[e.jsx(V,{className:"nav-icon",size:40}),e.jsx("h3",{style:{marginLeft:"10px"},children:"Employee Records"})]}),e.jsx(g,{color:"light",variant:"outline",onClick:()=>z("/EmployeeRegistration"),children:"Employee Registration"})]})}),e.jsxs(u,{className:"mb-3",children:[e.jsxs("div",{className:"d-flex justify-content-start mb-3",children:[e.jsxs(C,{className:"me-2",value:p,onChange:s=>D(s.target.value),children:[e.jsx("option",{value:"",children:"Filter by Department"}),e.jsx("option",{value:"CBM",children:"CBM"}),e.jsx("option",{value:"Parish",children:"Parish"}),e.jsx("option",{value:"NIMPA",children:"NIMPA"})]}),e.jsxs(C,{value:x,onChange:s=>U(s.target.value),children:[e.jsx("option",{value:"",children:"Filter by Job Type"}),e.jsx("option",{value:"Permanent",children:"Permanent"}),e.jsx("option",{value:"Intern",children:"Intern"}),e.jsx("option",{value:"Part-time",children:"Part-time"}),e.jsx("option",{value:"Casuals",children:"Casuals"}),e.jsx("option",{value:"Employment Contract",children:"Employment Contract"}),e.jsx("option",{value:"Service Contract",children:"Service Contract"})]})]}),e.jsx(i,{cl:!0,children:e.jsxs(g,{color:"primary",onClick:L,children:[e.jsx(Y,{icon:ae,style:{marginRight:"5px"}}),"Download Employee Records"]})})]}),e.jsxs(le,{striped:!0,bordered:!0,hover:!0,children:[e.jsx(ie,{children:e.jsxs(A,{color:"primary",children:[e.jsx(n,{children:"UserId"}),e.jsx(n,{children:"First Name"}),e.jsx(n,{children:"Middle Name"}),e.jsx(n,{children:"Surname"}),e.jsx(n,{children:"Employee No."}),e.jsx(n,{children:"Phone Number"}),e.jsx(n,{children:"Department"}),e.jsx(n,{children:"Job Type"}),e.jsx(n,{children:"Profession"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(ce,{children:k.map(s=>e.jsxs(A,{className:"text-center border",children:[e.jsx(o,{children:s.id}),e.jsx(o,{children:s.firstName}),e.jsx(o,{children:s.middleName}),e.jsx(o,{children:s.surname||"N/A"}),e.jsx(o,{children:s.employeeNo}),e.jsx(o,{children:s.phoneNumber}),e.jsx(o,{children:s.department}),e.jsx(o,{children:s.jobType}),e.jsx(o,{children:s.profession}),e.jsx(o,{children:s.status==0?e.jsx("span",{style:{color:"red",fontWeight:"600"},children:"Inactive"}):e.jsx("span",{style:{color:"green",fontWeight:"600"},children:"Active"})}),e.jsx(o,{children:e.jsx(g,{color:"primary",size:"sm",onClick:()=>H(s),children:"Update"})})]},s.id||s.employeeNo||Math.random()))})]}),e.jsxs(_,{visible:F,onClose:()=>y(!1),size:"lg",children:[e.jsx(K,{closeButton:!0,children:e.jsx(de,{children:"Update Employee"})}),e.jsx(Q,{children:t&&e.jsxs(re,{children:[e.jsxs(u,{children:[e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{children:"First Name"}),e.jsx(j,{type:"text",name:"firstName",value:t.firstName,onChange:c})]})}),e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{children:"Middle Name"}),e.jsx(j,{type:"text",name:"middleName",value:t.middleName,onChange:c})]})})]}),e.jsxs(u,{children:[e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{children:"Surname"}),e.jsx(j,{type:"text",name:"surname",value:t.surname,onChange:c})]})}),e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{children:"Phone Number"}),e.jsx(j,{type:"text",name:"phoneNumber",value:t.phoneNumber,onChange:c})]})})]}),e.jsxs(u,{children:[e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{children:"Department"}),e.jsxs(C,{name:"department",value:t.department,onChange:c,children:[e.jsx("option",{children:"Department"}),e.jsx("option",{value:"Parish",children:"Parish"}),e.jsx("option",{value:"CBM",children:"CBM"}),e.jsx("option",{value:"NIMPA",children:"NIMPA"})]})]})}),e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{children:"jobType"}),e.jsxs(C,{name:"jobType",value:t.jobType,onChange:c,children:[e.jsx("option",{children:"Job Type"}),e.jsx("option",{value:"Permanent",children:"Permanent"}),e.jsx("option",{value:"Intern",children:"Intern"}),e.jsx("option",{value:"Part-time",children:"Part-time"}),e.jsx("option",{value:"Casuals",children:"Casuals"}),e.jsx("option",{value:"Employment Contract",children:"Employment Contract"}),e.jsx("option",{value:"Service Contract",children:"Service Contract"})]})]})})]}),e.jsxs(u,{children:[e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{children:"profession"}),e.jsx(j,{type:"text",name:"profession",value:t.profession,onChange:c})]})}),e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{children:"Employee No"}),e.jsx(j,{type:"text",name:"Employee No",value:t.employeeNo,onChange:c})]})})]}),e.jsx(u,{children:e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{children:"Status"}),e.jsxs(C,{name:"status",value:t.status,onChange:c,required:!0,children:[e.jsx("option",{children:"Status"}),e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})})})]})}),e.jsxs(Z,{children:[e.jsx(g,{color:"secondary",onClick:()=>y(!1),children:"Cancel"}),e.jsx(g,{color:"primary",onClick:J,children:"Save Changes"})]})]})]})})})};export{we as default};
